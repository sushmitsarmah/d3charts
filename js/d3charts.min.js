d3Charts=function(){d3Charts={version:"0.1"};d3Charts.lineAreaChart=function(vals){if(typeof vals=="undefined"){vals={top:30,bottom:50,left:60,right:30,width:800,height:600,xscale:"months",selector:"body"}}this.selector=d3.keys(vals).indexOf("selector")==-1?"body":vals.selector,this.top=d3.keys(vals).indexOf("top")==-1?30:vals.top,this.bottom=d3.keys(vals).indexOf("bottom")==-1?30:vals.bottom,this.left=d3.keys(vals).indexOf("left")==-1?40:vals.left,this.right=d3.keys(vals).indexOf("right")==-1?30:vals.right,this.width=d3.keys(vals).indexOf("width")==-1?1200:vals.width,this.height=d3.keys(vals).indexOf("height")==-1?600:vals.height,this.xscale=d3.keys(vals).indexOf("xscale")==-1?"months":vals.xscale;if(this.xscale=="weeks"){xscale=d3.time.weeks;xformat=d3.time.format("%U")}else{xscale=d3.time.months;xformat=d3.time.format("%b-%y")}var margin={top:this.top,bottom:this.bottom,left:this.left,right:this.right},width=this.width-margin.right-margin.left,height=this.height-margin.top-margin.bottom;var x=d3.time.scale().range([0,width]);var y=d3.scale.linear().range([height,0]);var xAxis=d3.svg.axis().scale(x).orient("bottom").ticks(12).ticks(xscale).tickFormat(xformat);var yAxis=d3.svg.axis().scale(y).orient("left").ticks(5);function make_x_axis(){return d3.svg.axis().scale(x).orient("bottom").ticks(12).ticks(xscale)}function make_y_axis(){return d3.svg.axis().scale(y).orient("left").ticks(5)}var parsedate=d3.time.format("%Y-%m-%d").parse;var drawLine=d3.svg.line().interpolate("cardinal").x(function(d){return x(d.date)}).y(function(d){return y(d.followers)});var drawArea=d3.svg.area().interpolate("cardinal").x(function(d){return x(d.date)}).y0(height).y1(function(d){return y(d.followers)});this.init=function(json){var keys=Object.keys(json[0]);json=json.map(function(d){d.date=parsedate(d.date);d.followers=+d.followers;return d});x.domain(d3.extent(json,function(d){return d.date}));y.domain([0,d3.max(json,function(d){return d.followers})]);var svg=d3.select(this.selector).append("svg").datum(json).attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("class","chart").attr("transform","translate("+margin.left+","+margin.top+")");svg.append("g").attr("class","y-grid grid").call(make_y_axis().tickSize(-width,0,0).tickFormat(""));svg.append("g").attr("class","x-grid grid").call(make_x_axis().tickSize(height,0,0).tickFormat(""));svg.append("path").attr("class","area").attr("d",drawArea);svg.append("path").attr("class","line").attr("d",drawLine);svg.append("g").attr("class","bubbles").selectAll("circle").data(json).enter().append("circle").attr("cx",drawLine.x()).attr("cy",drawLine.y()).attr("r","5px").attr("fill","#2f7ed8").attr("title",function(d){return keys[0]+":"+d[keys[0]].toDateString()+";"+keys[1]+":"+d[keys[1]]}).on("mouseover",function(d){d3.select(this).attr({r:"10px",stroke:"white","stroke-width":"1px"})}).on("mouseout",function(d){d3.select(this).attr({r:"5px",stroke:"none","stroke-width":"0px"})});svg.append("g").attr("class","x axis").attr("transform","translate(0,"+height+")").call(xAxis);svg.append("text").attr("x",width/2).attr("y",height+margin.bottom).style("text-anchor","middle").text(this.xscale);svg.append("g").attr("class","y axis").call(yAxis);svg.append("text").attr("transform","rotate(-90)").attr("x",-height/2).attr("y",-margin.left).attr("dy","1em").style("text-anchor","middle").text(keys[1]);$("[title]").tooltip({container:"body",html:true,animation:true})};this.update=function(json){var keys=Object.keys(json[0]);json=json.map(function(d){d.date=typeof d.date=="object"?d.date:parsedate(d.date);d.followers=+d.followers;return d});x.domain(d3.extent(json,function(d){return d.date}));y.domain([0,d3.max(json,function(d){return d.followers})]);var svg=d3.select(".chart").transition();svg.select(".y-grid").duration(1e3).ease("easeInOutSine").call(make_y_axis().tickSize(-width,0,0).tickFormat(""));svg.select(".x-grid").duration(1e3).ease("easeInOutSine").call(make_x_axis().tickSize(height,0,0).tickFormat(""));svg.select(".line").duration(1e3).ease("easeInOutSine").attr("d",drawLine(json));svg.select(".area").duration(1e3).ease("easeInOutSine").attr("d",drawArea(json));svg.select(".x.axis").duration(1e3).ease("easeInOutSine").call(xAxis);svg.select(".y.axis").duration(1e3).ease("easeInOutSine").call(yAxis);var c=d3.select(".bubbles").selectAll("circle").data(json,function(d){return d.date});c.enter().insert("circle").attr("cx",function(d){return x(d.date)}).attr("cy",function(d){return y(d.followers)}).attr("r","5px").attr("fill","#2f7ed8").attr("title",function(d){return keys[0]+":"+d[keys[0]].toDateString()+";"+keys[1]+":"+d[keys[1]]}).on("mouseover",function(d){d3.select(this).attr({r:"10px",stroke:"white","stroke-width":"1px"})}).on("mouseout",function(d){d3.select(this).attr({r:"5px",stroke:"none","stroke-width":"0px"})});c.transition().duration(1e3).ease("cubic-in-out").attr("cx",function(d){return x(d.date)}).attr("cy",drawLine.y());c.exit().remove();$("[title]").tooltip({container:"body",html:true,animation:true})}};return d3Charts}();